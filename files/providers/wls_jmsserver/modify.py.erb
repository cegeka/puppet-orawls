# check the domain else we need to skip this (done in wls_access.rb)
real_domain='<%= domain %>'



name                        = '<%= jmsserver_name %>'
target                      = '<%= target %>'
targettype                  = '<%= targettype %>'
persistentstore             = '<%= persistentstore %>'
persistentstoretype         = '<%= persistentstoretype %>'
bytes_maximum               = '<%= bytes_maximum %>'
store_enabled               = '<%= store_enabled %>'
allows_persistent_downgrade = '<%= allows_persistent_downgrade %>'

edit()
startEdit()

try:

    cd('/JMSServers/'+name)

    if bytes_maximum:
      set('BytesMaximum',int(bytes_maximum))

    if allows_persistent_downgrade == '1':
      set('AllowsPersistentDowngrade','true')
    else:
      set('AllowsPersistentDowngrade','false')

    if store_enabled == '1':
      set('StoreEnabled', 'true')
    else:
      set('StoreEnabled', 'false')

    cd('/Deployments/'+name)

    if persistentstoretype == "FileStore":
      cmo.setPersistentStore(getMBean('/FileStores/'+persistentstore))
    elif persistentstoretype == "JDBCStore":
      cmo.setPersistentStore(getMBean('/JDBCStores/'+persistentstore))

    set('Targets', jarray.array([ObjectName('com.bea:Name='+target+',Type='+targettype)], ObjectName))

    save()
    activate()          
    print "~~~~COMMAND SUCCESFULL~~~~"

except:
    print "Unexpected error:", sys.exc_info()[0]
    undo('true','y')
    stopEdit('y')
    print "~~~~COMMAND FAILED~~~~"
    raise



